/*
 * Copyright 2015 Red Hat, Inc. and/or its affiliates.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
*/

package org.engcia;
// package must be defined in packages from kmodule.xml file

//list any import classes here.
import org.engcia.BaseConhecimento.Hypothesis;
import org.engcia.BaseConhecimento.Conclusion;
import org.engcia.BaseConhecimento.Evidences
import java.io.BufferedReader
import java.io.InputStreamReader
import org.engcia.Components.Storage
import org.engcia.Services.Questions
import java.util.List;


//declare any global variables here

query "Conclusions"
	$conclusion : Conclusion()
end

rule "r1"
	when
		Evidences(  300 < maxBudget < 600 )
	then
		Hypothesis h = new Hypothesis();
		h.budgetType = Hypothesis.BudgetType.BAIXO;
		insert(h);
end

rule "r2"
	when
		Evidences(  600 < maxBudget < 1000 )
	then
		Hypothesis h = new Hypothesis();
        h.budgetType = Hypothesis.BudgetType.MEDIO_BAIXO;
        insert(h);
end

rule "r3"
	when
		Evidences(  1000 < maxBudget < 1500 )
	then
		Hypothesis h = new Hypothesis();
        h.budgetType = Hypothesis.BudgetType.MEDIO;
        insert(h);
end

rule "r4"
	when
		Evidences(  1500 < maxBudget < 2000 )
	then
		Hypothesis h = new Hypothesis();
        h.budgetType = Hypothesis.BudgetType.MEDIO_ALTO;
        insert(h);
end

rule "r5"
	when
		Evidences(  2000 < maxBudget )
	then
		Hypothesis h = new Hypothesis();
        h.budgetType = Hypothesis.BudgetType.ALTO;
        insert(h);
end

rule "r6"
	when
		$hypothesis : Hypothesis( budgetType == BudgetType.BAIXO)
	then
	    BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
	    System.out.println("Escolha a finalidade: \n");
	    System.out.println("-" + Hypothesis.Finality.NAVEGACAO_WEB_SIMPLES  + "\n  -" + Hypothesis.Finality.NAVEGACAO_WEB_COMPLEXO +
	    "\n -" + Hypothesis.Finality.APLICACOES_OFFICE_BASICO + "\n -" + Hypothesis.Finality.APLICACOES_OFFICE_PROFISSIONAL +
	     "\n -" + Hypothesis.Finality.APLICACOES_PROFISSIONAIS_SEM_BASE_DADOS + "\n -" + Hypothesis.Finality.APLICACOES_PROFISSIONAIS_COM_BASE_DADOS);
        String finality = br.readLine();
        $hypothesis.finality = Hypothesis.Finality.valueOf(finality.toUpperCase());
		update($hypothesis);
end

rule "r7"
	when
		$hypothesis : Hypothesis( budgetType != BudgetType.BAIXO)
	then
		 BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
         System.out.println("Escolha a finalidade: \n");
         for ( Hypothesis.Finality fnlt: Hypothesis.Finality.values() ) {
            System.out.println("-" + fnlt);
         }
         String finality = br.readLine();
         $hypothesis.finality = Hypothesis.Finality.valueOf(finality.toUpperCase());
         update($hypothesis);
end

rule "r8"
	when
		$hypothesis : Hypothesis( finality == Hypothesis.Finality.NAVEGACAO_WEB_SIMPLES || finality == Hypothesis.Finality.NAVEGACAO_WEB_COMPLEXO ||
		 finality == Hypothesis.Finality.APLICACOES_OFFICE_BASICO || finality == Hypothesis.Finality.APLICACOES_OFFICE_PROFISSIONAL )
	then
		BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        System.out.println("Quando tempo irÃ¡ utilizar o computador por dia? \n");
        System.out.println("1. 2 a 4 horas \n");
        System.out.println("2. Mais de 4 horas \n");
        int choice = Integer.parseInt(br.readLine());
        $hypothesis.durationDayChoice = choice;
        update($hypothesis);

end

rule "r9"
	when
		$hypothesis : Hypothesis( finality != Hypothesis.Finality.NAVEGACAO_WEB_SIMPLES && finality != Hypothesis.Finality.NAVEGACAO_WEB_COMPLEXO &&
		 finality != Hypothesis.Finality.APLICACOES_OFFICE_BASICO && finality != Hypothesis.Finality.APLICACOES_OFFICE_PROFISSIONAL )
	then
		$hypothesis.durationDayChoice = 2;
        update($hypothesis);
end

rule "r10"
	when
		$hypothesis : Hypothesis (finality == Hypothesis.Finality.NAVEGACAO_WEB_SIMPLES || finality == Hypothesis.Finality.NAVEGACAO_WEB_COMPLEXO)
	then
	    Storage storage = new Storage();
	    storage.isSSD = true;
	    storage.capacityGB = "240 GB";
        List<Storage> storageList = Questions.questionStorage(storage);
        if(storageList.size() == 2){
            $hypothesis.scndStorage = storageList.get(1);
        }
        $hypothesis.storage = storageList.get(0);
        update($hypothesis);
end

rule "r11"
	when
		//Hypothesis( description == "lower type")
		//Evidences(bloodAnus == "yes", bloodCoffee == "yes")
	then
		Conclusion c = new Conclusion(Conclusion.MELENA);
		insert(c);
end

rule "r12"
	when
		//Hypothesis( description == "lower type")
		//Evidences(bloodAnus == "yes", bloodCoffee == "no")
	then
		Conclusion c = new Conclusion(Conclusion.RECTAL_BLEEDING);
		insert(c);
end

rule "unknown"
	when
		not Conclusion()
	then
		Conclusion c = new Conclusion(Conclusion.UNKNOWN);
		insert(c);
end

